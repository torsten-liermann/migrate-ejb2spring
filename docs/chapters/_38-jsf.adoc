== JSF
JSF is a component-based UI framework with server-side state and strong container reference. Spring Boot does not provide direct JSF integration as standard. A migration therefore requires a conscious decision for the UI model and the runtime environment.
.Specification references****
* https://jakarta.ee/specifications/faces/4.0/jakarta-faces-spec-4.0.html[Jakarta Faces 4.0 Spec]
* https://jakarta.ee/specifications/faces/4.0/jakarta-faces-spec-4.0.html#a4207[Jakarta Faces 4.0 - Chapter 7: Lifecycle]
* https://jakarta.ee/specifications/faces/4.0/jakarta-faces-spec-4.0.html#a5097[Jakarta Faces 4.0 - Chapter 11: Custom Components]
* https://docs.joinfaces.org/[JoinFaces Documentation]****

=== Migration options in the project context
The project uses JoinFaces to further operate JSF in the Spring Boot runtime. This option enables the operation of existing XHTML views. CDI and Spring remain separate contexts; The integration depends on the project and must be checked.
.Migration options
[cols="1,2,1"]|===
| approach | Description | status

| JoinFaces
| JSF on Spring Boot, UI remains
| Project decision

| Thymeleaf
| Server-side templates, new UI development
| Alternative

| SPA + REST
| Separate frontend with backend API
| Alternative
|===

=== JoinFaces strategy
JoinFaces provides Spring Boot starters for JSF implementations (Mojarra, MyFaces) and component libraries (PrimeFaces, OmniFaces). The integration enables:
* Operation of existing XHTML views without changes
* Spring Dependency Injection in JSF Managed Beans (depending on configuration and scope)
* Automatic resource configuration
==== Scope illustration
JSF-specific scopes such as @ViewScoped are tied to the JSF lifecycle. `@ConversationScoped` is not supported in JoinFaces and requires manual migration.
[cols="1,2,2"]|===
| CDI Scope | Mapping | Note

| `@RequestScoped`
| Spring `request`
| Scope‑Mapping

| `@SessionScoped`
| Spring `session`
| Scope‑Mapping

| `@ViewScoped`
| JoinFaces‑ViewScope
| JoinFaces‑eigener Scope

| `@ConversationScoped`
| not supported
| Manuelle Migration erforderlich
|===

==== Compatibility
Verified for project baseline (as of 2026-01-23). See https://github.com/joinfaces/joinfaces/releases[JoinFaces Releases] for current compatibility.

[cols="1,1,1,1"]|===
| JoinFaces | Spring Boot | Jakarta EE | Java

| 5.3.x
| 3.3.x–3.5.x
| EE 10
| 17+
|===

=== Configuration
JSF migration can be controlled via `project.yaml`:
[source,yaml]----
migration:
  jsf:
    runtime: joinfaces   # or: manual
----

==== Strategies
[cols="1.3"]|===
| Strategy | Description

| `joinfaces` (default)
| JSF scopes (`@ViewScoped`, `@FlowScoped`) remain unchanged. JoinFaces provides the runtime. Classes are marked with `@NeedsReview(category=CONFIGURATION)` for directory-structure verification.

| `manual`
| JSF scopes are marked with `@NeedsReview(category=MANUAL_MIGRATION)` for manual migration to Spring scopes. No JoinFaces.
|===

**Note:** `@ConversationScoped` is always marked with `@NeedsReview(category=SEMANTIC_CHANGE)` regardless of the strategy because there is no direct Spring equivalent.
==== Idea: JSF without Spring Boot
Even though this project is primarily based on Spring Boot, operation without Spring Boot makes sense in individual cases, for example when operating in an application server with an existing JSF stack. In this case, concepts from JoinFaces can be adopted without using boot-specific auto-configuration:
* **Scope implementation:** View/Flow scopes are based on `FacesContext` and `ViewMap`. This logic is independent of Spring Boot.
* **Registration as Spring Scope:** Without boot, registration must be done explicitly (e.g. via `CustomScopeConfigurer`).
* **Scope mapping:** The idea of ​​mapping JSF scopes to Spring scopes remains transferable; only the boot integration is omitted.
JoinFaces separates **implementation** and **activation**:
* **Implementation:** The actual scope (e.g. `org.joinfaces.viewscope.ViewScope`) is Spring‑compatible and not bound to Boot.
* **Activation:** Activation occurs in JoinFaces via boot auto configurations (e.g. `FacesScopeAnnotationsAutoConfiguration`, `CdiScopeAnnotationsAutoConfiguration`).
The implementation can be used without Spring Boot if the activation is recreated manually in a Spring configuration (scope registration + annotation mapping).
This path is an optional architectural decision and does not affect the default strategy (JoinFaces).
=== Automated migration
==== Available recipes
[cols="1.3"]|===
| Name | Description

| `com.github.rewrite.ejb.AddJoinFacesDependencies`
| Adds JoinFaces BOM, starter and Maven plugin; recognizes PrimeFaces/MyFaces.

| `com.github.rewrite.ejb.MoveJsfResourcesToMetaInf`
| Moves JSF resources to `META-INF/resources`.

| `com.github.rewrite.ejb.MarkJsfForMigration`
| Marks JSF classes depending on `migration.jsf.runtime`: CONFIGURATION (joinfaces) or MANUAL_MIGRATION (manual); ConversationScoped remains SEMANTIC_CHANGE.

| `com.github.rewrite.ejb.MigrateJsfContextParams`
| Migrates JSF context parameters from web.xml to application.properties.

| `com.github.rewrite.ejb.CleanupJsfWebXml`
| Removes FacesServlet and JSF configuration from web.xml.

| `com.github.rewrite.ejb.ConfigureJsfSession`
| Configures JSF session handling for Spring Boot.

| `com.github.rewrite.ejb.RewriteJsfResourceReferences`
| Customizes JSF resource paths for Spring Boot.

| `com.github.rewrite.ejb.AddJsfExceptionHandler`
| Adds JSF exception handler configuration.
|===

==== Resource shifting
[cols="1,1"]|===
| Quellpfad | Zielpfad

| `src/main/webapp/WEB-INF/faces-config.xml`
| `src/main/resources/META-INF/faces-config.xml`

| `src/main/webapp/*.xhtml`
| `src/main/resources/META-INF/resources/*.xhtml`

| `src/main/webapp/resources/*`
| `src/main/resources/META-INF/resources/*`
|===

=== Checkpoints for the project
* `faces-config.xml` version and compatible JSF version
* `javax.faces.PROJECT_STAGE` or `joinfaces.jsf.project-stage`
* PrimeFaces theme configuration (if used)
* ResourceLibraryContracts (if used)
* CDI extensions and custom scopes
See also: link:../migration-guide/jsf-migration.md[JSF Migration Guide]